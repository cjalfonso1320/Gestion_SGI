<div class="doc-accordion">
  {% macro render_carpeta(c, nivel=0) %}
    {% if nivel == 0 %}
      <div class="doc-section">{{ c.nombre }}</div>
      <div class="doc-content">
        {% if c.archivos %}
          <div class="tbl-header">
            <table cellpadding="0" cellspacing="0" border="0">
              <thead>
                <tr>
                  <th>Archivo</th>
                  <th>Tipo</th>
                  <th>Acciones</th>
                </tr>
              </thead>
            </table>
          </div>
          <div class="tbl-content">
            <table cellpadding="0" cellspacing="0" border="0">
              <tbody>
                {% for archivo in c.archivos %}
                  {% set tipo = archivo.split('.')[-1].lower() %}
                  {% set ruta = (c.ruta.rstrip('/') ~ '/' ~ archivo.lstrip('/')) %}
                  <tr>
                    <td>{{ archivo }}</td>
                    <td>.{{ tipo }}</td>
                    <td>
                      {% if tipo == 'pdf' %}
                        <a target="_blank" href="{{ url_for('doc.ver_documento', filepath=ruta) }}" class="custom-btn btn-5">Ver</a> |
                      {% endif %}
                      <a href="{{ url_for('doc.descargar_documento', filepath=ruta) }}" class="custom-btn btn-5">Descargar</a>
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% endif %}

        {% for h in c.hijos %}
          {{ render_carpeta(h, 1) }}
        {% endfor %}
      </div>
    {% elif nivel == 1 %}
      <div class="doc-subsection">{{ c.nombre }}</div>
      <div class="doc-subcontent">
        {% if c.archivos %}
          <div class="tbl-header">
            <table cellpadding="0" cellspacing="0" border="0">
              <thead>
                <tr>
                  <th>Archivo</th>
                  <th>Tipo</th>
                  <th>Acciones</th>
                </tr>
              </thead>
            </table>
          </div>
          <div class="tbl-content">
            <table cellpadding="0" cellspacing="0" border="0">
              <tbody>
                {% for archivo in c.archivos %}
                  {% set tipo = archivo.split('.')[-1].lower() %}
                  {% set ruta = (c.ruta.rstrip('/') ~ '/' ~ archivo.lstrip('/')) %}
                  <tr>
                    <td>{{ archivo }}</td>
                    <td>.{{ tipo }}</td>
                    <td>
                      {% if tipo == 'pdf' %}
                        <a target="_blank" href="{{ url_for('doc.ver_documento', filepath=ruta) }}" class="custom-btn btn-5">Ver</a> |
                      {% endif %}
                      <a href="{{ url_for('doc.descargar_documento', filepath=ruta) }}" class="custom-btn btn-5">Descargar</a>
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% endif %}

        {% for h in c.hijos %}
          {{ render_carpeta(h, 2) }}
        {% endfor %}
      </div>
    {% else %}
      <div class="doc-subsubsection">{{ c.nombre }}</div>
      <div class="doc-subsubcontent">
        {% if c.archivos %}
          <div class="tbl-header">
            <table cellpadding="0" cellspacing="0" border="0">
              <thead>
                <tr>
                  <th>Archivo</th>
                  <th>Tipo</th>
                  <th>Acciones</th>
                </tr>
              </thead>
            </table>
          </div>
          <div class="tbl-content">
            <table cellpadding="0" cellspacing="0" border="0">
              <tbody>
                {% for archivo in c.archivos %}
                  {% set tipo = archivo.split('.')[-1].lower() %}
                  {% set ruta = (c.ruta.rstrip('/') ~ '/' ~ archivo.lstrip('/')) %}
                  <tr>
                    <td>{{ archivo }}</td>
                    <td>.{{ tipo }}</td>
                    <td>
                      {% if tipo == 'pdf' %}
                        <a target="_blank" href="{{ url_for('doc.ver_documento', filepath=ruta) }}" class="custom-btn btn-5">Ver</a> |
                      {% endif %}
                      <a href="{{ url_for('doc.descargar_documento', filepath=ruta) }}" class="custom-btn btn-5">Descargar</a>
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% endif %}

        {% for h in c.hijos %}
          {{ render_carpeta(h, nivel + 1) }}
        {% endfor %}
      </div>
    {% endif %}
  {% endmacro %}

  {% for carpeta in archivos_UsoInterno %}
    {{ render_carpeta(carpeta, 0) }}
  {% endfor %}
</div>
